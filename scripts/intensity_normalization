import os
import soundfile as sf

root_dataset_path = r"path/to/input_dataset" 
output_dataset_path = r"path/to/output_dataset"

# MATCH THESE TO YOUR FOLDER NAMES EXACTLY
remap = {
    "AA": 0.0, 
    "SS": 0.0, 
    "P": 0.0, 
    "E": 0.0,
    "F": -3.0, 
    "D": -3.0, 
    "R": -3.0,
    "N": -7.0, 
    "AS": -7.0, 
    "G": -7.0,
    "SD": -12.0, 
    "IB": -12.0
}

for folder_name in os.listdir(root_dataset_path):
    input_folder = os.path.join(root_dataset_path, folder_name)
    
    if not os.path.isdir(input_folder):
        continue
    
    if folder_name not in remap:
        print(f"WARNING: Folder '{folder_name}' not in arousal mapping. Skipping.")
        continue
    
    db_drop = remap[folder_name]
    multiplier = 10 ** (db_drop / 20)  # Convert dB to amplitude multiplier
    
    # Create output folder
    output_folder = os.path.join(output_dataset_path, folder_name)
    os.makedirs(output_folder, exist_ok=True)
    
    print(f"Processing {folder_name} (Drop: {db_drop}dB)...")
    
    for file_name in os.listdir(input_folder):
        if file_name.lower().endswith((".wav", ".flac")):
            # Load, multiply, and save
            data, rate = sf.read(os.path.join(input_folder, file_name))
            fixed_data = data * multiplier
            sf.write(os.path.join(output_folder, file_name), fixed_data, rate)

print("\nSuccess! All folders processed.")
